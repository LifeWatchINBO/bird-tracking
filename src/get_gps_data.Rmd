---
title: "Download UvA-BiTS tracking data as Movebank GPS data"
author: "Peter Desmet"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

Load libraries:

```{r}
library(tidyverse)
library(here)
library(glue)
```

# Connect to UvA-BiTS database

Get connection settings from `odbc.ini` (not included in this repo) and connect to database:

```{r connect_to_uvabits}
con <- dbConnect(odbc::odbc(), "uvabits")
```

# Download tracking data as Movebank GPS data

...

Set values:

```{r}
project <- "MH_WATERLAND"
device_info_serial <- 586
```

Query data:

```{r}
sql <- glue_sql(read_file(here("sql", "movebank_gps_data.sql")), .con = con)
movebank_gps_data <- dbGetQuery(con, sql)
```

Save to CSV:

```{r}
write_csv(movebank_gps_data, path = here("data", "processed", project, paste0("movebank_gps_data_", device_info_serial, ".csv")), na = "")
```
